<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">

</head>
<link th:href="@{/css/boostrap.min.css}">
<link th:href="@{/css/bootstrap.min.css}" rel='stylesheet'>
<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
<link rel="stylesheet" type="text/css" th:href="@{/css/jquery.datetimepicker.min.css}" />
<body>

	<div style="width: 50%;margin: 0px auto;margin-top: 5%;" class="bg-white border rounded-5">
		<section class="w-100 p-4 text-center pb-4">
		<div th:if="${status}" class="alert" th:classappend="${status} ? alert-success : alert-danger" th:text="${error_paid}"></div>
			<form method="POST" th:object="${date_data}" th:action="@{/citas}">
				<!-- 2 column grid layout with text inputs for the first and last names -->
				<div class="row mb-4">
					<div class="col">
						<div class="form-outline">
							<input type="text" class="form-control text-center" th:field="*{fullName}" required/>
							<label class="form-label">Nombres</label>
						</div>
					</div>
					<div class="col">
						<div class="form-outline">
							<input type="text" class="form-control text-center" th:field="*{lastName}" required/>
							<label class="form-label" >Apellidos</label>
						</div>
					</div>
				</div>

				<!-- Text input -->
				<div class="form-outline mb-4">
					<input type="text" class="form-control text-center" th:field="*{address}" required/>
					<label class="form-label" >Dirección</label>
				</div>

				<!-- Email input -->
				<div class="form-outline mb-4">
					<input type="email" class="form-control text-center" th:field="*{email}"/>
					<label class="form-label" >Correo electrónico</label>
				</div>

				<!-- Number input -->
				<div class="form-outline mb-4">
					<input type="text" class="form-control text-center" th:field="*{phone}" required />
					<label class="form-label" >Teléfono de contacto</label>
				</div>
				<div class="form-outline mb-4">
				<select class="form-control text-center" required id="place" th:field="*{place}">
					<option value="LOCAL">
						Local
					</option>
					<option value="VISITA">
						Visita
					</option>
					</select>
					<label class="form-label">Lugar</label>
				</div>
				<div class="form-outline mb-4">
					<input type="date" id="date" name="date" class="form-control text-center" onchange="getHoursDate(this.value)" th:filed="*{date}" required>
					<label class="form-label" for="date">Fecha de cita</label>
				</div>
				<div class="form-outline mb-4">
				<select class="form-control text-center" onchange="console.log(this.value)" required id="hours_available" th:field="*{time}">
					<option value="">
						--Sin horas--
					</option>
					</select>
					<label class="form-label" for="datetimepicker">Hora de cita</label>
				</div>
				<!-- Message input -->
				<div class="form-outline mb-4">
					<textarea class="form-control" rows="4" th:field="*{comments}"></textarea>
					<label class="form-label" >Comentarios adicionales</label>
				</div>


				<!-- Submit button -->
				<button type="submit" class="btn btn-primary btn-block mb-4">Reservar cita</button>
			</form>
		</section>
	</div>
	<script th:src="@{/js/jquery.js}" type="text/javascript"></script>
	<script th:src="@{/js/jquery.datetimepicker.js}"></script>
	<script th:src="@{/js/jquery.datetimepicker.full.js}"></script>
	<script>
	$(document).ready(function() {
    });
    function getHoursDate(date){
		$.ajax({
				method: "GET",
				url: "[[@{/dates/getHours/}]]" + date
			}).done(function (value) {
				//hours_available
				let select= document.querySelector("#hours_available");
				select.innerHTML="";
				value.forEach(item=> select.innerHTML+=`<option>${item}</option>`);
			});
	}
	</script>
</body>
</html>